
# ESP32 S3 Power Monitor & Overload Protection with NETPIE 2020

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢ ESP32 ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡πÇ‡∏°‡∏î‡∏π‡∏• PZEM-004T v3.0 ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ú‡πà‡∏≤‡∏ô‡∏à‡∏≠ LCD I2C 16x2 ‡πÇ‡∏î‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° NETPIE 2020 ‡∏ú‡πà‡∏≤‡∏ô‡πÇ‡∏õ‡∏£‡πÇ‡∏ï‡∏Ñ‡∏≠‡∏• MQTT ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô (Volt, Amp, Power, Energy) ‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå
‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ WiFi ‡∏ó‡∏µ‡πà‡∏á‡πà‡∏≤‡∏¢‡∏î‡∏≤‡∏¢‡∏ú‡πà‡∏≤‡∏ô **WiFiManager** (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Æ‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏Ñ‡πâ‡∏î SSID/Password) ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö **Overload Protection** ‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡πÑ‡∏Å‡∏•‡∏ú‡πà‡∏≤‡∏ô NETPIE ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå‡∏à‡∏∞‡∏ï‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

## ‚ú® ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥ (Features)

-   **‡∏ß‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå** (Volt, Amp, Power, Energy) ‡∏à‡∏≤‡∏Å PZEM-004T v3.0
    
-   **‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° NETPIE 2020** ‡∏ú‡πà‡∏≤‡∏ô MQTT
    
-   **‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå (‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î)** ‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡πÑ‡∏Å‡∏•‡∏ú‡πà‡∏≤‡∏ô NETPIE
    
-   **‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÑ‡∏ü‡πÄ‡∏Å‡∏¥‡∏ô (Overload Protection)** ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ï‡∏±‡∏î‡πÑ‡∏ü‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    
-   **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏£‡∏∞‡πÅ‡∏™ Overload ‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡πÑ‡∏Å‡∏•** (‡∏Ñ‡πà‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô NETPIE Shadow)
    
-   **‡πÉ‡∏ä‡πâ WiFiManager** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ WiFi ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏ú‡πà‡∏≤‡∏ô Web Portal (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î)
    
-   **‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤ WiFi** ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° BOOT (GPIO 0) ‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡∏Ç‡∏ì‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
    
-   **‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞** ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ‡∏ö‡∏ô‡∏à‡∏≠ 16x2 I2C LCD
    
-   **‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î** (Relay, Overload) ‡∏Å‡∏±‡∏ö NETPIE Device Shadow ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
    

## üõ†Ô∏è ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ (Hardware Required)

1.  **ESP32 S3** 
    
2.  **PZEM-004T v3.0** (‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏ß‡∏±‡∏î‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô) ‡∏û‡∏£‡πâ‡∏≠‡∏° CT Coil
    
3.  **Relay Module** (‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå 1 ‡∏ä‡πà‡∏≠‡∏á)
    
4.  **16x2 I2C LCD Display** (‡∏à‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•)
    
5.  ‡∏™‡∏≤‡∏¢‡πÑ‡∏ü Jumper
    

## üìö ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (Libraries Required)

‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡∏ú‡πà‡∏≤‡∏ô Arduino IDE Library Manager:

-   `PubSubClient` (by Nick O'Leary)
    
-   `ArduinoJson` (by Benoit Blanchon)
    
-   `LiquidCrystal_I2C` (by Frank de Brabander)
    
-   `PZEM-004T-v30` (by mandulaj)
    
-   `WiFiManager` (by tzapu)
    

## üîå ‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏ß‡∏á‡∏à‡∏£ (Hardware Setup / Wiring)

-   **I2C LCD Display:**
    
    -   `SDA` -> `GPIO 21` (ESP32)
        
    -   `SCL` -> `GPIO 22` (ESP32)
        
    -   `VCC` -> `5V`
        
    -   `GND` -> `GND`
        
-   **PZEM-004T v3.0 (UART):**
    
    -   `TX` -> `GPIO 17` (ESP32 RX2)
        
    -   `RX` -> `GPIO 18` (ESP32 TX2)
        
    -   `5V` -> `5V`
        
    -   `GND` -> `GND`
        
-   **Relay Module:**
    
    -   `IN` -> `GPIO 38` (ESP32)
        
    -   `VCC` -> `5V`
        
    -   `GND` -> `GND`
        
-   **‡∏õ‡∏∏‡πà‡∏° Reset WiFi:**
    
    -   ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° **BOOT** ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏ö‡∏≠‡∏£‡πå‡∏î (`GPIO 0`)
        

**‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á:** `GPIO 38` ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô‡∏ö‡∏≠‡∏£‡πå‡∏î ESP32-WROOM-32 ‡∏£‡∏∏‡πà‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà ‡∏´‡∏≤‡∏Å‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏°‡∏µ Pin ‡∏ô‡∏µ‡πâ ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤ `int relay = 38;` ‡πÄ‡∏õ‡πá‡∏ô GPIO ‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà

## ‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (Configuration)

### 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ NETPIE 2020

1.  ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [NETPIE 2020](https://netpie.io/ "null") ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Device ‡πÉ‡∏´‡∏°‡πà
    
2.  ‡∏à‡∏î **Device ID**, **Token** ‡πÅ‡∏•‡∏∞ **Secret** ‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤ Device
    
3.  ‡∏ô‡∏≥‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á 3 ‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô `NETPIE2020` ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `.ino`:
    
    ```
    // -------- NETPIE2020 --------
    const char* mqttServer = "broker.netpie.io";
    const int mqttPort = 1883;
    const char* mqttClientID = "your Device ID";    // <-- ‡πÉ‡∏™‡πà Device ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const char* mqttUsername = "your Token";      // <-- ‡πÉ‡∏™‡πà Token ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const char* mqttPassword = "your Secret";     // <-- ‡πÉ‡∏™‡πà Secret ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    
    ```
    

### 2. ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏Ñ‡πâ‡∏î ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ WiFi

1.  ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡∏¢‡∏±‡∏á ESP32
    
2.  ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ESP32 ‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Access Point (AP) ‡∏ä‡∏∑‡πà‡∏≠ **"ESP32-PZEM-Setup"**
    
3.  ‡πÉ‡∏ä‡πâ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ WiFi ‡∏ô‡∏µ‡πâ
    
4.  ‡∏´‡∏ô‡πâ‡∏≤ Captive Portal (‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤) ‡∏à‡∏∞‡πÄ‡∏î‡πâ‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î Browser ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡∏ó‡∏µ‡πà `192.168.4.1`)
    
5.  ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Configure WiFi" ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ WiFi ‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
    
6.  ESP32 ‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ WiFi ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ NETPIE 2020 ‡∏ï‡πà‡∏≠‡πÑ‡∏õ
    

### 3. ‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ WiFi

‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô WiFi ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ:

1.  ‡∏ñ‡∏≠‡∏î‡∏õ‡∏•‡∏±‡πä‡∏Å ESP32
    
2.  ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° **BOOT** (GPIO 0) ‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ
    
3.  ‡πÄ‡∏™‡∏µ‡∏¢‡∏ö‡∏õ‡∏•‡∏±‡πä‡∏Å ESP32 (‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° BOOT ‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ)
    
4.  ‡∏£‡∏≠ 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ) ‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∂‡∏á‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏°‡∏∑‡∏≠
    
5.  ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏à‡∏∞‡∏•‡∏ö‡∏Ñ‡πà‡∏≤ WiFi ‡πÅ‡∏•‡∏∞‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡πÉ‡∏´‡πâ‡∏ñ‡∏≠‡∏î‡∏õ‡∏•‡∏±‡πä‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏™‡∏µ‡∏¢‡∏ö‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ WiFiManager ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
    

## üöÄ ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö NETPIE 2020 (MQTT Topics)

### 1. Topics ‡∏ó‡∏µ‡πà ESP32 ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ (Publish)

-   `@shadow/data/update`
    
    -   **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå (‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ):**
        
        ```
        {"data":{"volt":220.50,"amp":1.234,"power":270.00,"e":10.500}}
        
        ```
        
    -   **‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á):**
        
        -   ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Overload: `{"data":{"overload":5}}`
            
        -   ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏±‡πà‡∏á‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î Relay: `{"data":{"relay":1}}` ‡∏´‡∏£‡∏∑‡∏≠ `{"data":{"relay":0}}`
            
        -   ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î Overload: `{"data":{"relay":0,"StateOverload":1}}`
            
        -   ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏±‡πà‡∏á‡πÄ‡∏õ‡∏¥‡∏î Relay (‡∏•‡πâ‡∏≤‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Overload): `{"data":{"relay":1,"StateOverload":0}}`
            
-   `@shadow/data/get`
    
    -   **ESP32 ‡∏™‡πà‡∏á:** ‡∏™‡πà‡∏á Payload `{}` ‡∏ß‡πà‡∏≤‡∏á‡πÜ ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Topic ‡∏ô‡∏µ‡πâ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô Shadow
        

### 2. Topics ‡∏ó‡∏µ‡πà ESP32 ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á (Subscribe)

-   `@private/shadow/data/get/response`
    
    -   **ESP32 ‡∏£‡∏±‡∏ö:** ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Shadow (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ `relay` ‡πÅ‡∏•‡∏∞ `overload` ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î) ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏á `@shadow/data/get` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏±‡∏ö‡∏ö‡∏ô‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå
        
-   `@msg/relay`
    
    -   **ESP32 ‡∏£‡∏±‡∏ö:** ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå
        
    -   **Payload "1"**: ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå (‡πÅ‡∏•‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ `StateOverload`)
        
    -   **Payload "0"**: ‡∏õ‡∏¥‡∏î‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå
        
-   `@msg/overload`
    
    -   **ESP32 ‡∏£‡∏±‡∏ö:** ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÑ‡∏ü‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (Overload)
        
    -   **Payload (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á "5")**: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Overload ‡∏ó‡∏µ‡πà 5 ‡πÅ‡∏≠‡∏°‡∏õ‡πå
        

### 3. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Shadow (Shadow Data Structure)

‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô NETPIE Device Shadow ‡∏à‡∏∞‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

```
{
  "data": {
    "volt": 220.50,
    "amp": 1.234,
    "power": 270.00,
    "e": 10.500,
    "relay": 1,
    "overload": 5,
    "StateOverload": 0
  }
}

```

-   `relay`: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå (1=ON, 0=OFF)
    
-   `overload`: ‡∏Ñ‡πà‡∏≤‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ (‡πÄ‡∏ä‡πà‡∏ô 5 Amp)
    
-   `StateOverload`: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Overload (1=‡πÄ‡∏Å‡∏¥‡∏î Overload, 0=‡∏õ‡∏Å‡∏ï‡∏¥)
